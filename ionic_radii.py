"""
Shannon Ionic Radii Database
Data from Shannon, R.D. (1976) Acta Cryst. A32, 751-767
Keyed by symbol -> charge -> coordination_number -> radius (Ã…)
"""

IONIC_RADII = {
    'Li': {1: {4: 0.59, 6: 0.76, 8: 0.92}},
    'Na': {1: {4: 0.99, 6: 1.02, 8: 1.18, 9: 1.24, 12: 1.39}},
    'K':  {1: {4: 1.37, 6: 1.38, 8: 1.51, 9: 1.55, 10: 1.59, 12: 1.64}},
    'Rb': {1: {6: 1.52, 8: 1.61, 10: 1.66, 12: 1.72}},
    'Cs': {1: {6: 1.67, 8: 1.74, 10: 1.81, 12: 1.88}},
    'Be': {2: {4: 0.27, 6: 0.45}},
    'Mg': {2: {4: 0.57, 6: 0.72, 8: 0.89}},
    'Ca': {2: {6: 1.00, 8: 1.12, 9: 1.18, 10: 1.23, 12: 1.34}},
    'Sr': {2: {6: 1.18, 8: 1.26, 9: 1.31, 10: 1.36, 12: 1.44}},
    'Ba': {2: {6: 1.35, 8: 1.42, 9: 1.47, 10: 1.52, 12: 1.61}},
    'Sc': {3: {6: 0.745, 8: 0.87}},
    'Y':  {3: {6: 0.90, 8: 1.019, 9: 1.075}},
    'La': {3: {6: 1.032, 8: 1.16, 9: 1.216, 10: 1.27, 12: 1.36}},
    'Ce': {3: {6: 1.01, 8: 1.143, 9: 1.196, 10: 1.25, 12: 1.34}, 4: {6: 0.87, 8: 0.97, 10: 1.07, 12: 1.14}},
    'Pr': {3: {6: 0.99, 8: 1.126, 9: 1.179}, 4: {6: 0.85, 8: 0.96}},
    'Nd': {3: {6: 0.983, 8: 1.109, 9: 1.163, 12: 1.27}},
    'Sm': {3: {6: 0.958, 8: 1.079, 9: 1.132, 12: 1.24}},
    'Eu': {2: {6: 1.17, 8: 1.25, 9: 1.30, 10: 1.35}, 3: {6: 0.947, 8: 1.066, 9: 1.120}},
    'Gd': {3: {6: 0.938, 8: 1.053, 9: 1.107}},
    'Tb': {3: {6: 0.923, 8: 1.040, 9: 1.095}, 4: {6: 0.76, 8: 0.88}},
    'Dy': {3: {6: 0.912, 8: 1.027, 9: 1.083}},
    'Ho': {3: {6: 0.901, 8: 1.015, 9: 1.072}},
    'Er': {3: {6: 0.89, 8: 1.004, 9: 1.062}},
    'Tm': {3: {6: 0.88, 8: 0.994, 9: 1.052}},
    'Yb': {2: {6: 1.02, 8: 1.14}, 3: {6: 0.868, 8: 0.985, 9: 1.042}},
    'Lu': {3: {6: 0.861, 8: 0.977, 9: 1.032}},
    'Ti': {2: {6: 0.86}, 3: {6: 0.67}, 4: {4: 0.42, 6: 0.605, 8: 0.74}},
    'Zr': {4: {4: 0.59, 6: 0.72, 8: 0.84, 9: 0.89}},
    'Hf': {4: {4: 0.58, 6: 0.71, 8: 0.83}},
    'V':  {2: {6: 0.79}, 3: {6: 0.64}, 4: {6: 0.58, 8: 0.72}, 5: {4: 0.355, 6: 0.54}},
    'Nb': {3: {6: 0.72}, 4: {6: 0.68, 8: 0.79}, 5: {4: 0.48, 6: 0.64, 8: 0.74}},
    'Ta': {3: {6: 0.72}, 4: {6: 0.68}, 5: {6: 0.64, 8: 0.74}},
    'Cr': {2: {6: 0.80}, 3: {6: 0.615}, 4: {6: 0.55}, 6: {4: 0.26, 6: 0.44}},
    'Mo': {3: {6: 0.69}, 4: {6: 0.65}, 5: {6: 0.61}, 6: {4: 0.41, 6: 0.59}},
    'W':  {4: {6: 0.66}, 5: {6: 0.62}, 6: {4: 0.42, 6: 0.60}},
    'Mn': {2: {4: 0.66, 6: 0.83, 8: 0.96}, 3: {6: 0.645}, 4: {4: 0.39, 6: 0.53}, 7: {4: 0.25, 6: 0.46}},
    'Re': {4: {6: 0.63}, 5: {6: 0.58}, 6: {6: 0.55}, 7: {4: 0.38, 6: 0.53}},
    'Fe': {2: {4: 0.63, 6: 0.78, 8: 0.92}, 3: {4: 0.49, 6: 0.645, 8: 0.78}},
    'Co': {2: {4: 0.58, 6: 0.745, 8: 0.90}, 3: {6: 0.545}},
    'Ni': {2: {4: 0.55, 6: 0.69}, 3: {6: 0.56}},
    'Pd': {2: {4: 0.64, 6: 0.86}, 4: {6: 0.615}},
    'Pt': {2: {4: 0.60, 6: 0.80}, 4: {6: 0.625}},
    'Cu': {1: {4: 0.60, 6: 0.77}, 2: {4: 0.57, 6: 0.73}},
    'Ag': {1: {4: 1.00, 6: 1.15, 8: 1.28}, 2: {4: 0.79, 6: 0.94}},
    'Au': {1: {6: 1.37}, 3: {4: 0.68, 6: 0.85}},
    'Zn': {2: {4: 0.60, 6: 0.74, 8: 0.90}},
    'Cd': {2: {4: 0.78, 6: 0.95, 8: 1.10}},
    'Hg': {1: {6: 1.19}, 2: {4: 0.96, 6: 1.02, 8: 1.14}},
    'Al': {3: {4: 0.39, 6: 0.535}},
    'Ga': {3: {4: 0.47, 6: 0.62}},
    'In': {3: {4: 0.62, 6: 0.80, 8: 0.92}},
    'Tl': {1: {6: 1.50, 8: 1.59, 12: 1.70}, 3: {4: 0.75, 6: 0.885, 8: 0.98}},
    'Sn': {2: {6: 0.93, 8: 1.09}, 4: {4: 0.55, 6: 0.69, 8: 0.81}},
    'Pb': {2: {6: 1.19, 8: 1.29, 10: 1.40, 12: 1.49}, 4: {4: 0.65, 6: 0.775, 8: 0.94}},
    'Bi': {3: {6: 1.03, 8: 1.17}, 5: {6: 0.76}},
    'Sb': {3: {6: 0.76}, 5: {6: 0.60}},
    'As': {3: {6: 0.58}, 5: {4: 0.335, 6: 0.46}},
    'P':  {3: {6: 0.44}, 5: {4: 0.17, 6: 0.38}},
    'Si': {4: {4: 0.26, 6: 0.40}},
    'Ge': {2: {6: 0.73}, 4: {4: 0.39, 6: 0.53}},
    'B':  {3: {4: 0.11, 6: 0.27}},
    'Se': {4: {6: 0.50}, 6: {4: 0.28, 6: 0.42}},
    'Te': {4: {6: 0.97}, 6: {4: 0.43, 6: 0.56}},
    # Common anions (charge stored as negative int)
    'O':  {-2: {2: 1.35, 3: 1.36, 4: 1.38, 6: 1.40, 8: 1.42}},
    'S':  {-2: {6: 1.84}},
    'F':  {-1: {2: 1.285, 3: 1.30, 4: 1.31, 6: 1.33}},
    'Cl': {-1: {6: 1.81}},
    'Br': {-1: {6: 1.96}},
    'I':  {-1: {6: 2.20}},
    'N':  {-3: {4: 1.46}},
}


def get_ionic_radius(symbol: str, charge: int, cn: int) -> float | None:
    """Get ionic radius for given element, charge, and coordination number."""
    element = IONIC_RADII.get(symbol)
    if not element:
        return None
    charge_data = element.get(charge)
    if not charge_data:
        return None
    # Exact match
    if cn in charge_data:
        return charge_data[cn]
    # Find closest CN
    available = sorted(charge_data.keys())
    if not available:
        return None
    closest = min(available, key=lambda x: abs(x - cn))
    return charge_data[closest]


def get_available_cns(symbol: str, charge: int) -> list[int]:
    """Get list of available coordination numbers for element and charge."""
    element = IONIC_RADII.get(symbol)
    if not element:
        return []
    charge_data = element.get(charge)
    if not charge_data:
        return []
    return sorted(charge_data.keys())


def get_available_charges(symbol: str) -> list[int]:
    """Get list of available charges for element."""
    element = IONIC_RADII.get(symbol)
    if not element:
        return []
    return sorted(element.keys())


def get_all_cations() -> list[str]:
    """Get list of all cation symbols."""
    return [s for s, data in IONIC_RADII.items() if any(c > 0 for c in data.keys())]


def get_all_anions() -> list[str]:
    """Get list of all anion symbols."""
    return [s for s, data in IONIC_RADII.items() if any(c < 0 for c in data.keys())]
